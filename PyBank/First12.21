import  os
import csv

csvpath= os.path.join('budget_data.csv')
csvpath_w= os.path.join('PyBank.txt')

with open(csvpath) as csvfile:
    with open(csvpath_w,'w') as csvfile_w:

        csvreader=csv.reader(csvfile, delimiter=',')
        csvwriter=csv.writer(csvfile_w, delimiter=',')

        print(csvreader)

        csvheader = next(csvreader)
        # print(f'CSV Header: {csvheader}')

        # for row in csvreader:
        # 	print(row)
        # for columns in csvreader:
        #     print(columns)

        # print totals rows for months
        row_count = sum(1 for row in csvreader)
        print ('Total Months: ' , row_count)
        
        # this resets the loop to row 2 in excel
        csvfile.seek(0)
        csvheader = next(csvreader)

        # total sum of column 2 aka total P/L
        # deifnes the variable /container to begin at 0 outside of loop
        TotalSum= 0
        TotalAvg=0
        Changes=[]
        ChangeVal=0
        LastPL=0
        GreatIn=0
        GreatInMonth=''
        LeastIn=0
        LeastInMonth=''
        
        # this is not producing the same output as the homework example
        # loop through rows to calc total sum of column[1] aka B
        for rows in csvreader:
            PL=int(rows[1])
            TotalSum+=PL

            if LastPL != 0:
                ChangeVal=(PL-LastPL)
                Changes.append (ChangeVal)
                if GreatIn < ChangeVal:
                    GreatIn=ChangeVal
                    GreatInMonth=rows[0]
                if LeastIn > ChangeVal:
                    LeastIn=ChangeVal
                    LeastInMonth=rows[0]

            LastPL=PL

        # print(LastPL,PL)
        # print(len(Changes))

        print('Total: ','${:,.2f}'.format(TotalSum))
        print('Average Change: ','${:,.2f}'.format(sum(Changes)/row_count))
        print('Greatest increase in profits: ',GreatInMonth,'(${:,.2f})'.format(GreatIn))
        print('Greatest decrease in profits: ',LeastInMonth,'(${:,.2f})'.format(LeastIn))
        csvwriter.writerow(['Total: ','${:,.2f}'.format(TotalSum)])
        csvwriter.writerow(['Average Change: ','${:,.2f}'.format(sum(Changes)/row_count)])
        csvwriter.writerow(['Greatest increase in profits: ',GreatInMonth,'(${:,.2f})'.format(GreatIn)])
        csvwriter.writerow(['Greatest decrease in profits: ',LeastInMonth,'(${:,.2f})'.format(LeastIn)])
        
# with open(csvpath,'w') as csvfile
#     csvwriter=csv.writer(csvfile, delimiter=',')

#     csvwriter(['Total: ','${:,.2f}'.format(TotalSum)])
#     csvwriter('Average Change: ','${:,.2f}'.format(sum(Changes)/row_count))
#     csvwriter('Greatest increase in profits: ',GreatInMonth,'(${:,.2f})'.format(GreatIn))
#     csvwriter('Greatest decrease in profits: ',LeastInMonth,'(${:,.2f})'.format(LeastIn))
    